{% extends "base.html" %}
{% block title %}Analytics{% endblock %}
{% block page_title %}ğŸ“Š Analytics{% endblock %}

{% block content %}

<div class="analytics-grid fade-up">

     <!-- Pie: Defect Classes -->
     <div class="card">
          <div class="card-header">
               <div>
                    <div class="card-title">ğŸ¥§ Defect Class Distribution</div>
                    <div class="card-subtitle">Breakdown of detected defect types</div>
               </div>
               <span class="tag tag-cyan">Live</span>
          </div>
          <div class="chart-container" style="height:260px"><canvas id="aPieChart"></canvas></div>
     </div>

     <!-- Gauge: Pass Rate -->
     <div class="card">
          <div class="card-header">
               <div class="card-title">ğŸ¯ Pass Rate Gauge</div>
          </div>
          <div class="gauge-wrap">
               <div style="position:relative;width:200px;height:200px">
                    <canvas id="gaugeChart"></canvas>
                    <div
                         style="position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center">
                         <div class="gauge-value" id="gaugeValue">â€”</div>
                         <div class="gauge-label">Pass Rate</div>
                    </div>
               </div>
          </div>
     </div>

     <!-- Line: Confidence Trend -->
     <div class="card analytics-full">
          <div class="card-header">
               <div>
                    <div class="card-title">ğŸ“ˆ Confidence Trend Over Time</div>
                    <div class="card-subtitle">Model confidence across all inspections</div>
               </div>
               <span class="tag tag-violet">Time Series</span>
          </div>
          <div class="chart-container" style="height:220px"><canvas id="aLineChart"></canvas></div>
     </div>

     <!-- Area: Defect Frequency -->
     <div class="card analytics-full">
          <div class="card-header">
               <div>
                    <div class="card-title">ğŸ“‰ Defect Frequency Over Time</div>
                    <div class="card-subtitle">Number of defects detected per inspection</div>
               </div>
               <span class="tag tag-red">Area Chart</span>
          </div>
          <div class="chart-container" style="height:200px"><canvas id="aAreaChart"></canvas></div>
     </div>

     <!-- Bar: Model Comparison -->
     <div class="card">
          <div class="card-header">
               <div class="card-title">ğŸ† PASS vs FAIL Ratio</div>
          </div>
          <div class="chart-container" style="height:220px"><canvas id="aBarChart"></canvas></div>
     </div>

     <!-- Confusion Matrix Visual -->
     <div class="card">
          <div class="card-header">
               <div class="card-title">ğŸ”² Status Matrix</div>
          </div>
          <div id="confusionMatrix" style="display:grid;grid-template-columns:1fr 1fr;gap:0.75rem;margin-top:0.5rem">
               <div
                    style="background:var(--green-dim);border:1px solid rgba(16,185,129,0.25);border-radius:var(--radius-sm);padding:1.2rem;text-align:center">
                    <div style="font-size:1.8rem;font-weight:900;color:var(--green);font-family:var(--mono)" id="cmTP">0
                    </div>
                    <div style="font-size:0.72rem;color:var(--text-muted);margin-top:0.3rem">PASS (Correct)</div>
               </div>
               <div
                    style="background:var(--red-dim);border:1px solid rgba(239,68,68,0.25);border-radius:var(--radius-sm);padding:1.2rem;text-align:center">
                    <div style="font-size:1.8rem;font-weight:900;color:var(--red);font-family:var(--mono)" id="cmFP">0
                    </div>
                    <div style="font-size:0.72rem;color:var(--text-muted);margin-top:0.3rem">FAIL (Detected)</div>
               </div>
               <div
                    style="background:var(--amber-dim);border:1px solid rgba(245,158,11,0.25);border-radius:var(--radius-sm);padding:1.2rem;text-align:center">
                    <div style="font-size:1.8rem;font-weight:900;color:var(--amber);font-family:var(--mono)" id="cmAL">0
                    </div>
                    <div style="font-size:0.72rem;color:var(--text-muted);margin-top:0.3rem">Active Learning</div>
               </div>
               <div
                    style="background:var(--cyan-dim);border:1px solid rgba(6,182,212,0.25);border-radius:var(--radius-sm);padding:1.2rem;text-align:center">
                    <div style="font-size:1.8rem;font-weight:900;color:var(--cyan);font-family:var(--mono)"
                         id="cmTotal">0</div>
                    <div style="font-size:0.72rem;color:var(--text-muted);margin-top:0.3rem">Total Inspections</div>
               </div>
          </div>
     </div>

</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/charts.js') }}"></script>
<script>initAnalyticsCharts();</script>
{% endblock %}